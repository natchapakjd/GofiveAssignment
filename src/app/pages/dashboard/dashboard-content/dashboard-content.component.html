<div class="mx-5 ">
    <p class="text-2xl text-blue-500 mt-6 ml-11 font-bold">Users Dashboard</p>
    <div class="flex items-center">
        <input id="searchInput" class="border rounded-2xl w-8/12 h-12 my-5 mr-2 relative" type="text"
            [(ngModel)]="searchText" (input)="searchUsers()" placeholder="Search" />
        <img class="absolute text-base ml-5" src="../../../assets/icons/fluent_search-24-filled.png" alt="">
        <button class="w-36 h-12 bg-blue-500 text-white text-base border font-semibold rounded-md ml-7 mr-8"
            (click)="addUserToggle()">Add user +</button>
        <div class="relative flex mr-5" (click)="sortToggle()">
            <span class="mr-2 text-base font-semibold">Sort by</span>
            <img src="../../../assets/icons/mdi_chevron-down.png" alt="" class="mr-2">
            @if(isSortToggle){
            <div class="absolute top-10 w-1/6 bg-white  h-full border rounded-md ">
                <ul class="text-center">
                    <li class="hover:bg-gray-100" (click)="sortUsersByFirstName()"><a class="text-sm ">FirstName</a>
                    </li>
                    <li class="hover:bg-gray-100" (click)="sortUsersByLastName()"><a class="text-sm ">LastName</a></li>
                    <li class="hover:bg-gray-100" (click)="sortUsersByEmail()"><a class="text-sm ">Email</a></li>
                </ul>

            </div>
            }
        </div>
        <div class="flex" (click)="saveSearch()">
            <span class="mr-2 text-base font-semibold">Saved search</span>
            <img src="../../../assets/icons/mdi_chevron-down.png" alt="" class="mr-2">
        </div>

        <img class="mx-auto" src="../../../assets/icons/Filter.png" alt="">
    </div>
    <form #form="ngForm" (ngSubmit)="onFormSubmit()">
        @if (toggle === true) {
        <div class="container flex justify-center">
            <div class="block fixed mx-auto bg-white rounded-md w-9/12 pt-5 top-8 overflow-hidden  ">
                <div class="flex justify-between w-full mb-5 ">
                    <div class="w-1/2 ml-5 font-semibold">
                        <p>Add User</p>
                    </div>
                    <div class="w-1/2 mr-5">
                        <img src="../../../../assets/icons/alert-circle.png" alt="" class="ml-auto "
                            (click)="addUserToggle()">
                    </div>
                </div>
                <hr>
                <div class="mx-5">
                    <input type="text" class="mt-5 mb-3 border w-full  h-8 rounded-md" placeholder="User ID *"
                        [(ngModel)]="createUserModel.id" name="id" id="id">
                    <div class="flex justify-between gap-5 my-3">
                        <input type="text" class=" border w-full  h-8 rounded-md" placeholder="First Name *"
                            [(ngModel)]="createUserModel.firstName" name="firstName" id="firstName">
                        <input type="text" class=" border w-full  h-8 rounded-md" placeholder="Last Name *"
                            [(ngModel)]="createUserModel.lastName" name="lastName" id="lastName">
                    </div>
                    <div class="flex justify-between gap-5">
                        <input type="text" class="my-3 border w-full  h-8 rounded-md" placeholder="Email ID *"
                            [(ngModel)]="createUserModel.email" name="email" id="email">
                        <input type="text" class="my-3 border w-full  h-8 rounded-md" placeholder="Mobile No"
                            [(ngModel)]="createUserModel.phone" name="phone" id="phone">
                        <select class="my-3 border w-full  h-8 rounded-md" name="roleId" id="roleId"
                            [(ngModel)]="createUserModel.roleId">

                            @for(role of roles;track role ){
                            <option [value]="role.roleId">{{role.roleName}}</option>

                            }
                        </select>
                    </div>
                    <div class="flex justify-between gap-5">
                        <input type="text" class="my-3 border w-full  h-8 rounded-md" placeholder="Username *"
                            [(ngModel)]="createUserModel.userName" name="userName" id="userName">
                        <input type="text" class="my-3 border w-full  h-8 rounded-md" placeholder="Password*"
                            [(ngModel)]="createUserModel.password" name="password" id="password">
                        <input type="text" class="mt-3 border w-full  h-8 rounded-md" placeholder="Confirm Password*"
                            [(ngModel)]="newPassword" name="newPassword" id="newPassword">
                    </div>
                </div>
                <div class="flex justify-between h-16 bg-gray-200 mt-9 items-center">
                    <div class="font font-semibold text-gray-500 w-1/2 ml-7">Module Permission</div>
                    <div class="flex  justify-between  font-semibold text-gray-500  w-1/2 mr-36">
                        <p>Read</p>
                        <p>Write</p>
                        <p>Delete</p>
                    </div>
                </div>
                @for (p of permissions; let i = $index ; track p ) {
                <div class="flex justify-between h-16 bg-white  items-center">
                    <div class="font font-semibold text-gray-500 w-1/2 ml-7">{{p.permissionName}}</div>
                    <div class="flex justify-between font-semibold text-gray-500 w-1/2 mr-36">
                        <input type="checkbox" class="h-4 w-4 ml-2" name="isReadable" id="isReadable">
                        <input type="checkbox" class="h-4 w-4" name="isWritable" id="isWritable">
                        <input type="checkbox" class="h-4 w-4 mr-2" name="isDeletable" id="isDeletable">
                    </div>

                </div>
                <hr>
                }
                <div class="flex flex-row-reverse gap-5 h-16 mx-5 my-auto py-5">
                    <p class="text-gray-200">Cancel</p>
                    <button class="bg-blue-500 w-24 h-7 text-white font-semibold rounded-xl">Add user</button>

                </div>
            </div>
        </div>
        }
    </form>
    @if (delToggle === true) {
    <div class="container flex justify-center ">
        <div class="block fixed mx-auto bg-white rounded-md w-1/3 h-1/3 pt-5 top-30 overflow-hidden  ">
            <div class="flex justify-between w-full mb-5 ">
                <div class="mx-5 font-semibold">
                    <p class="text-2xl my-2">Delete this account ?</p>
                    <p class="font-normal my-2">Lorem ipsum, dolor sit amet consectetur adipisicing elit. Vel animi sed
                        et dicta at ut ipsam laborum deserunt fuga, placeat quasi, perspiciatis nesciunt? Ipsa quisquam
                        molestias, ut dolorum consequatur et.</p>
                    <div class="flex gap-5 justify-end	">
                        <button class="bg-red-500 text-white w-24 h-7 rounded-md" (click)="onDelete()">Yes,
                            Delete</button>
                        <button class=" text-gray-600 w-24 h-7 rounded-md bg-gray-100"
                            (click)="addDeleteToggle()">Cancel</button>
                    </div>
                </div>

            </div>
        </div>
    </div>
    }
    @if (editToggle === true ) {
    <div class="container flex justify-center ">
        <div class="block fixed mx-auto bg-white rounded-md w-9/12 pt-5 top-8 overflow-hidden  ">
            <div class="flex justify-between w-full mb-5 ">
                <div class="w-1/2 ml-5 font-semibold">
                    <p>Edit User</p>
                </div>
                <div class="w-1/2 mr-5">
                    <img src="../../../../assets/icons/alert-circle.png" alt="" class="ml-auto "
                        (click)="addEditToggle()">
                </div>
            </div>
            <hr>
            <div class="mx-5">
                <input type="text" class="mt-5 mb-3 border w-full h-8 rounded-md" placeholder="User ID *"
                    value="{{user.id}}">
                <div class="flex justify-between gap-5 my-3">
                    <input type="text" class=" border w-full  h-8 rounded-md" value="{{user.firstName}}"
                        placeholder="firstName *" [(ngModel)]="editUserModel.firstName">
                    <input type="text" class=" border w-full  h-8 rounded-md" value="{{user.lastName}}"
                        placeholder="lastName *" [(ngModel)]="editUserModel.lastName">
                </div>
                <div class="flex justify-between gap-5">
                    <input type="text" class="my-3 border w-full  h-8 rounded-md" value="{{user.email}}"
                        placeholder="email *" [(ngModel)]="editUserModel.email">
                    <input type="text" class="my-3 border w-full  h-8 rounded-md" value="{{user.phone}}"
                        placeholder="phone *" [(ngModel)]="editUserModel.phone">
                    <select class="my-3 border w-full  h-8 rounded-md" name="roleId" id="roleId"
                        [(ngModel)]="editUserModel.roleId">

                        @for(role of roles;track role ){
                        <option [value]="role.roleId">{{role.roleName}}</option>

                        }
                    </select>
                </div>
                <div class="flex justify-between gap-5">
                    <input type="text" class="my-3 border w-full  h-8 rounded-md" value="{{user.userName}}"
                        placeholder="username *" [(ngModel)]="editUserModel.userName">
                    <input type="text" class="my-3 border w-full  h-8 rounded-md" value="{{user.password}}"
                        placeholder="password *" [(ngModel)]="editUserModel.password">
                    <input type="text" class="mt-3 border w-full  h-8 rounded-md" placeholder="Confirm Password*"
                        [(ngModel)]="newPassword">
                </div>
            </div>
            <div class="flex justify-between h-16 bg-gray-200 mt-9 items-center">
                <div class="font font-semibold text-gray-500 w-1/2 ml-7">Module Permission</div>
                <div class="flex  justify-between  font-semibold text-gray-500  w-1/2 mr-36">
                    <p>Read</p>
                    <p>Write</p>
                    <p>Delete</p>
                </div>
            </div>
            @for (permission of permissions; track permission) {
            <div class="flex justify-between h-16 bg-white  items-center">
                <div class="font font-semibold text-gray-500 w-1/2 ml-7">{{permission.permissionName}}</div>
                <div class="flex justify-between font-semibold text-gray-500 w-1/2 mr-36">
                    <input type="checkbox" class="h-4 w-4 ml-2">
                    <input type="checkbox" class="h-4 w-4">
                    <input type="checkbox" class="h-4 w-4 mr-2">
                </div>
            </div>
            <hr>
            }
            <div class="flex flex-row-reverse gap-5 h-16 mx-5 my-auto py-5">
                <p class="text-gray-200">Cancel</p>
                <button class="bg-blue-500 w-24 h-7 text-white font-semibold rounded-xl"
                    (click)="onFormSubmit2(id)">Edit user</button>
            </div>
        </div>
    </div>
    }
    <div class="mt-7 rounded-md bg-white">
        <p class="ml-7 text-base pt-4 font-semibold mb-5">List Users</p>
        <div class="bg-gray-200  flex justify-between h-16 items-center">
            <p class="ml-8 mr-96 text-gray-600">Name</p>
            <p class="text-gray-600">Create date</p>
            <p class="text-gray-600">Role</p>
            <p class="mr-8">Action</p>
        </div>
    </div>
    @for(user of users;track user ){
    <div class="bg-white  flex h-20">
        <div class="flex justify-between   w-1/2 my-auto">
            <div class="w-2/3">
                <p class="ml-14">{{user.firstName}} {{user.lastName}}</p>
                <p class="ml-14 mr-36 text-sm text-gray-300">{{user.email}}</p>
            </div>
            <div class="my-auto mx-auto w-1/3">
                @if(user.roleId == "3"){
                <button class="bg-gray-200 rounded-md w-24 h-7 my-auto text-gray-600 text-sm w-28">Employee</button>

                }@else {
                <button class="bg-blue-500 rounded-md w-24 h-7 my-auto text-white text-sm w-28">@switch (user.roleId)
                    {
                    @case ("1") {
                    Super Admin
                    }
                    @case ("2") {
                    Admin
                    }
                    }
                </button>
                }
            </div>
        </div>
        <div class="flex  my-auto   w-4/6 justify-between  ">
            <p class="ml-20" (click)="formatDate(user.createdDate)">{{user.createdDate}}</p>
            <p class="ml-7">Lorem ipsum</p>
            <div class="flex gap-5">
                <img src="../../../../assets/icons/pen.png" alt="" class="w-5 h-5 " (click)="addEditToggle()"
                    (click)="setId(user.id)">
                <img src="../../../../assets/icons/arrow-circle-down Copy.png" alt="" class="w-5 h-5 mr-6"
                    (click)="addDeleteToggle()" (click)="setId(user.id)
                ">
            </div>
        </div>
    </div>
    <hr>
    }
    <div class="flex w-96 mx-auto justify-center mt-14 mb-7">
        <div class="flex gap-7">
            <p class="text-gray-500">Items per page: </p>
            <div class="flex gap-5 relative">
                <p class="text-gray-500">6</p>
                <img src="../../../../assets/icons/Polygon 2.png" alt="" class="w-3 h-3 mt-2">
                <div class="w-11 h-px bg-gray-500 absolute bottom-0"></div>
            </div>
            <p class="text-gray-500">1-4 of 10</p>
        </div>
        <div class="flex gap-7 mx-5">
            <img src="../../../../assets/icons/Icon.png" alt="" class="h-3 w-3 mt-2">
            <img src="../../../../assets/icons/Icon (1).png" alt="" class="h-3 w-3 mt-2">
        </div>
    </div>
</div>